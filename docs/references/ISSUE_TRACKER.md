# Issue Tracker Seed List

Use this file as the canonical backlog. GitHub Issues are no longer used—close any existing GitHub issues (#1–#25) and track status here only.

## Maintenance Checklist

- Add a row only when the work is groomed enough to act on.
- Update the **Status** column directly in this file; do not open matching GitHub issues.
- After closing or reprioritising work, reflect the status change here and adjust acceptance criteria if the scope evolves.
- Cross-check this file at the start/end of each session (see `session/current_session.md`) so the backlog stays aligned.

## MVP Implementation Sequence

1. AUTH-001 – Magic-link authentication foundation (#20).
2. AUTH-002 – Learner profiles & admin invite console (#21).
3. AUTH-003 – Device-key coexistence & sunset toolkit (#22).
4. ADM-006 – Admin user management console (new).
5. PROG-001 – Progress persistence schema & API surface (new).
6. PROG-002 – Learner UI progress integration (new).
7. PROG-003 – Admin progress insights & reporting (new).

> Legacy items removed from scope are catalogued in `docs/REMOVED_FROM_SCOPE.md`.

## Learner Experience

| ID     | Title                                 | Description                                                                                                          | Acceptance Criteria                                                                                                                                                                                                                       | Status                                                 |
| ------ | ------------------------------------- | -------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------ |
| LX-001 | Build Section Board Layout            | Implement responsive section board UI showing top-level curriculum sections, progress badges, and CTA into the tree. | 1. SvelteKit route renders board for mobile & desktop breakpoints.<br>2. Sections load from Supabase `curriculum_nodes` level 1.<br>3. Progress badge placeholder wired to mock data.<br>4. Touch interactions tested on narrow viewport. | Closed – trimmed launch delivered                      |
| LX-002 | Implement Collapsible Tree Navigation | Provide expandable hierarchy view with lazy-loaded nodes/items and prerequisite highlights.                          | 1. Tree component collapses/expands levels without reloading page.<br>2. Fetches child nodes on demand using Supabase RPC or REST.<br>3. Highlights prerequisites with badges.<br>4. Analytics event fired on node open.                  | Closed – badges show zero until public dependency view |
| LX-003 | Concept Detail Page Structure         | Compose concept view header, definitions, media carousel, and action bar using canonical concept seed.               | 1. Page consumes Supabase `concepts` record by slug.<br>2. Breadcrumb shows curriculum path.<br>3. Prerequisite/next-step drawers display stub data.<br>4. Action buttons emit events and update local state.                             | Closed – UI polish landed 2025-11-06                   |

## Automation & Regression Guards

| ID       | Title                        | Description                                                                      | Acceptance Criteria                                                                                                                                                                                      | Status |
| -------- | ---------------------------- | -------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| AUTO-001 | Seed Regeneration CI Check   | Add CI workflow step to run `npm run content:seed:generate` and fail on diff.    | 1. GitHub Action executes seed generation.<br>2. Workflow fails if repo dirty afterwards.<br>3. Docs updated with workflow link.<br>4. Badge added to README (optional).                                 | Done   |
| AUTO-002 | Curriculum Snapshot Job      | Automate refresh of `docs/static_info/curriculum_in_supabase.csv` in CI/nightly. | 1. Script runs `node tests/exportCurriculumTree.mjs --format csv --out docs/static_info/curriculum_in_supabase.csv`.<br>2. Job uploads artifact or commits file via bot.<br>3. Run documented in README. | Done   |
| AUTO-003 | Concept Markdown Schema Test | Validate markdown tables before seed generation to catch malformed rows.         | 1. Node script reads `docs/static_info/LBS_concepts_master.md` and validates headings.<br>2. CI runs script prior to seeds.<br>3. Failure message points to offending section.                           | Done   |

## Data & Backend

| ID       | Title                                     | Description                                                                                             | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                  | Status                                                            |
| -------- | ----------------------------------------- | ------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------- |
| DB-001   | Curriculum Dependency Schema Finalisation | Finalise `curriculum_dependencies` table structure, indexes, and seeding strategy.                      | 1. Schema documented with columns & constraints.<br>2. Migration drafted and reviewed.<br>3. Seed builder updated to populate dependencies.<br>4. Session log updated with decision summary.                                                                                                                                                         | Closed – schema + seeds in place                                  |
| DB-002   | Content Versioning Model                  | Define `content_versions` + `content_drafts` tables with audit fields and status transitions.           | 1. ERD/diagram produced.<br>2. Migration stub created.<br>3. API contracts aligned.<br>4. Permissions annotated for Supabase policies.                                                                                                                                                                                                               | Closed – rollback history + drafts live; see `npm run test:db002` |
| PROG-001 | Progress Persistence Schema & API         | Design Supabase tables, enums, and endpoints that capture learner progress with authenticated sessions. | 1. Schema documented in `SCHEMA_DECISIONS.md` with migrations ready for review.<br>2. Express API exposes `GET/PUT /api/v1/progress` endpoints guarded by auth role claims.<br>3. Legacy device-key writes coexist via feature flag.<br>4. Automated smoke (`npm run test:progress001`, placeholder) drafted to validate insert/update/delete flows. | Planned – issue to be opened post AUTH-002                        |
| PROG-002 | Learner UI Progress Integration           | Wire the learner experience to the new progress APIs and surface completion state in UI.                | 1. Concept view reflects authenticated completion state with optimistic updates.<br>2. Section board and tree badge progress consume shared store.<br>3. Offline guardrails documented; unauthenticated fallback gracefully prompts login.<br>4. QA checklist updated with progress regression steps.                                                | Planned – issue to be opened post PROG-001                        |
| PROG-003 | Admin Progress Insights                   | Provide `/admin` reporting for learner progress metrics.                                                | 1. Admin dashboard lists active learners, completion counts, and last-seen timestamps.<br>2. Export or CSV download available for further analysis.<br>3. Access limited to admin role with audit logging.<br>4. Documentation updated in `ADMIN_SETUP.md` and `ANALYTICS_EVENTS.md`.                                                                | Planned – issue to be opened post PROG-002                        |

> Update this document as issues are opened, and link back to the corresponding GitHub issue numbers.

## Auth & Accounts

| ID       | Title                                   | Description                                                                                          | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Status                          |
| -------- | --------------------------------------- | ---------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------- |
| AUTH-001 | Magic-Link Auth Foundation              | Configure Supabase email magic-link login, wire session handling, and expose basic sign-in surfaces. | 1. Supabase project enables passwordless email links with staging/production secrets wired through `env.js` + backend `.env`.<br>2. Frontend shows a localized magic-link request/confirmation flow and persists Supabase sessions in the shared auth store.<br>3. Backend verifies `app_role` claims on learner APIs; guests continue to read via device key.<br>4. Docs updated (`MASTER_PLAN.md`, `PERSONAS_PERMISSIONS.md`, `DEVELOPMENT_SETUP.md`) describing setup and local dev flags.      | In progress – high priority     |
| AUTH-002 | Learner Profiles & Admin Invite Console | Create learner profile bootstrap, persist metadata, and ship an admin-only invite workflow.          | 1. `profiles` table (or equivalent view) stores learner metadata, row-level security documented and enforced.<br>2. Admin console surfaces an invite screen that sends Supabase magic links to allowed emails with localized copy.<br>3. Learner profile record auto-creates on first sign-in and exposes preferred language + optional callsign fields.<br>4. Docs updated (`PERSONAS_PERMISSIONS.md`, `ADMIN_SETUP.md`, `API_CONTRACTS.md`) plus GitHub issue template for manual invite review. | Planned – begins after AUTH-001 |
| AUTH-003 | Device-Key Coexistence & Sunset Toolkit | Monitor magic-link adoption, migrate existing device-key progress, and document the cutover plan.    | 1. Telemetry events capture login vs device-key usage and surface a minimal dashboard/report.<br>2. Migration script copies anonymous progress into authenticated profiles without data loss, including dry-run instructions.<br>3. Feature flag disables new device-key writes post-migration with documented rollback.<br>4. Appendix in `MASTER_PLAN.md` references the executed plan and links to results.                                                                                     | Planned – follows AUTH-002      |

### GitHub Issue Briefs

- **AUTH-001** – Scope: enable Supabase magic-link auth, surface learner login modal, ensure backend trusts sessions. Dependencies: Supabase secrets, existing device-key middleware. Copilot readiness: high once secrets/URLs stubbed; manual validation of email template and localisation required. Docs: `MASTER_PLAN.md`, `PERSONAS_PERMISSIONS.md`, `DEVELOPMENT_SETUP.md`.
- **AUTH-002** – Scope: create learner profile persistence and admin invite UI housed in the existing admin shell. Dependencies: AUTH-001, Supabase `profiles` migration. Copilot readiness: medium (UI + DB migrations) with human review for email content. Docs: `PERSONAS_PERMISSIONS.md`, `ADMIN_SETUP.md`, `API_CONTRACTS.md`.
- **AUTH-003** – Scope: collect adoption telemetry, backfill progress, and toggle device-key writes off. Dependencies: AUTH-001/002 shipped and stable. Copilot readiness: low (requires production data handling) but automation aids migration scripts. Docs: `MASTER_PLAN.md` appendix, `SCHEMA_DECISIONS.md`, future runbook TBD.

## Admin & Moderation Interface

| ID      | Title                         | Description                                                                                                   | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                      | Status                                          |
| ------- | ----------------------------- | ------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------- |
| ADM-001 | Secure Admin Shell Access     | Gate `/admin` routes behind Supabase `app_role='admin'`, provide fallback messaging, and log access outcomes. | 1. SvelteKit `/admin/+layout` verifies session role and redirects/guards non-admin users.<br>2. Express middleware enforces the same role check server-side.<br>3. Friendly "access denied" screen delivered with help text for learners/contributors.<br>4. Telemetry event logged for allow/deny decisions.<br>5. Documentation updated (`PERSONAS_PERMISSIONS.md`, `ADMIN_SETUP.md`). | Closed – guard shipped 2025-11-06               |
| ADM-002 | Concept Editor MVP            | Deliver editable Concepts table with create/edit flows, validation, and audit logging.                        | 1. Concepts grid lists term, status, section, and updated timestamp with filters.<br>2. Drawer/modal form supports create + edit with draft/publish toggle and validation shared with backend (Zod schema or equivalent).<br>3. Saves emit `content_versions` entries via API.<br>4. Unsaved-change guard implemented.<br>5. Success/failure toasts match design system.                 | Closed – ADM-002 polish complete                |
| ADM-006 | Admin User Management Console | Deliver `/admin/users` for invites, role toggles, and session oversight.                                      | 1. List view displays pending invites and active admins with pagination/search.<br>2. Invite form sends Supabase magic links and records status.<br>3. Role toggle (admin/learner) persists via API, guarded by audit logs.<br>4. Access limited to super-admin accounts documented in `PERSONAS_PERMISSIONS.md`.<br>5. QA checklist updated with invite/revoke smoke tests.             | Planned – issue to be opened alongside AUTH-002 |

## Media Intake & Embeds

| ID         | Title                             | Description                                                                                              | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Status                                                                     |
| ---------- | --------------------------------- | -------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| MEDIA-001  | Supabase Media Storage Foundation | Define buckets, ACL policies, and database migrations (`media_assets`, optional `media_asset_variants`). | 1. Migration scripts created and reviewed (tables, indexes, enum updates).<br>2. Bucket configuration documented (single admin bucket with RLS + signed URL policy).<br>3. Policies cover admin upload/read paths.<br>4. Docs updated (`SUPABASE.md`, `SCHEMA_DECISIONS.md`) with runbooks and seed instructions.                                                                                                                                                                                                                                                                   | Closed – migration 0011 + smoke `npm run test:media001` landed             |
| MEDIA-002  | Admin Media API Surface           | Implement Express routes for admin uploads, metadata, and signed URL retrieval.                          | 1. `POST /api/v1/admin/media` accepts metadata, enforces size/type limits, and writes to storage/db.<br>2. `GET /api/v1/admin/media` (list) and `GET /admin/media/:id/url` return signed URLs.<br>3. Error states documented in `API_CONTRACTS.md`.<br>4. Contract tests cover success, validation, and quota failures.                                                                                                                                                                                                                                                             | Closed – API + rate limiter shipped; PDF/document support added 2025-11-21 |
| MEDIA-002A | Admin Media Workspace UI          | Deliver `/admin/media` list view with filters, detail drawer, and enforcement of concept-linked assets.  | 1. SvelteKit page lists media with thumbnail, type, creator, createdAt, and related concept.<br>2. Filters support concept picker, asset type, source, and free-text search; pagination uses API cursor.<br>3. Detail drawer shows preview/metadata, surfaces signed URL fetch, and allows delete with storage outcome messaging.<br>4. Removing the final concept association triggers asset deletion and reflects immediately in UI.<br>5. Rate-limit errors render inline notices/toasts with retry guidance.                                                                    | Closed – workspace shipped 2025-11-18; reassignment fixes 2025-11-20       |
| MEDIA-002B | Admin Media Creation Flow         | Build admin-only creation drawer supporting uploads and external links with signed upload assistance.    | 1. Drawer requires selecting exactly one concept before metadata entry; submission blocked otherwise.<br>2. Upload path validates file type/size client-side, calls `POST /admin/media`, and performs signed upload via built-in drop zone.<br>3. External path enforces HTTPS + whitelisted providers and captures localized captions.<br>4. Success state automatically uploads to Supabase using signed instructions, emits a confirmation toast, and refreshes list/context.<br>5. Rate-limit and validation failures surface actionable messaging, no orphaned assets created. | Closed – creation drawer + external flow shipped 2025-11-18                |
| MEDIA-002C | Concept Media Attachments         | Extend concept editor to display, attach, and remove media while preventing orphaned assets.             | 1. Concept drawer lists existing media with summary metadata, source/type badge, and quick actions (open in media workspace, delete).                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|            |                                   |                                                                                                          | 2. “Pridėti mediją” button opens creation drawer with the concept locked; successful uploads refresh the attachment list immediately.<br>3. Deleting an attachment removes the Supabase object when applicable and confirms via toast.<br>4. Concept view surfaces backend rate-limit/validation errors via existing toast/banner system.<br>5. Admin guide updated with step-by-step instructions for attaching/removing media from a concept.                                                                                                                                     | Closed – concept attachments + admin instructions live                     |
